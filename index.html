<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Lion Milestones 2025</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#c76a3f">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Lion Milestones">

<style>
body{font-family:-apple-system,Segoe UI,Roboto;background:#fff8ef;color:#3b2b20;padding:20px}
.container{max-width:1200px;margin:auto}
h1{text-align:center}
.track{position:relative;height:300px;margin:40px 0}
.path{position:absolute;left:4%;right:4%;top:170px;height:12px;background:#e7d6c6;border-radius:12px}
.segment{position:absolute;top:0;height:100%;background:#e7d6c6;border-radius:12px}
.segment.complete{background:linear-gradient(90deg,#f3a36b,#d9534f)}
.paw{position:absolute;top:50%;transform:translateY(-50%);font-size:22px;opacity:0}
.paw.show{opacity:1}
.paw.walk{animation:pawWalk 1s ease infinite}
@keyframes pawWalk{
 0%{transform:translate(-6px,-50%)}
 50%{transform:translate(6px,-50%)}
 100%{transform:translate(-6px,-50%)}
}
.lionWrap{position:absolute;top:20px;left:4%;width:150px;transition:left .4s}
.lion{width:100%}
.crown{position:absolute;left:50%;top:-36px;transform:translateX(-50%);width:76px;display:none}
.crown.show{display:block}
.settings,.top{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-bottom:12px}
.settings div,.top div{background:#fff;padding:10px;border-radius:8px;border:1px solid #e8d6c7}
.goal{background:#fff;border-radius:8px;padding:10px;margin:10px}
.sub{margin-left:26px;color:#555}
button{padding:8px 14px;border:none;border-radius:8px;background:#c76a3f;color:#fff;margin:4px}
button.secondary{background:#8b5a41}
input[type=text],input[type=date]{padding:6px;border-radius:6px;border:1px solid #ddd}
</style>
</head>
<body>
<div class="container">
<h1>2025 Lion Milestones</h1>

<div class="top">
  <div><strong>Progress:</strong> <span id="progress">0%</span></div>
</div>

<div class="settings">
  <div>
    <strong>Replace Lion</strong><br>
    <input type="file" id="lionUpload" accept="image/*"><br>
    <button class="secondary" onclick="restoreLion()">Restore</button>
  </div>
  <div>
    <strong>Replace Crown</strong><br>
    <input type="file" id="crownUpload" accept="image/*"><br>
    <button class="secondary" onclick="restoreCrown()">Restore</button>
  </div>
  <div>
    <strong>Quick Actions</strong><br>
    <button onclick="saveState()">Save</button>
    <button class="secondary" onclick="clearState()">Clear</button>
  </div>
</div>

<div class="track">
  <div class="path" id="path"></div>
  <div class="lionWrap" id="lionWrap">
    <img id="lion" class="lion" src="https://upload.wikimedia.org/wikipedia/commons/7/73/Lion_waiting_in_Namibia.jpg">
    <img id="crown" class="crown" src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Golden_crown.svg">
  </div>
</div>

<button onclick="addGoal()">âž• Add Goal</button>
<button onclick="resetProgress()">Reset</button>

<div id="goals"></div>
</div>

<script>
let GOALS=[
 {name:"Business Growth",target:"2025-03-31",subgoals:[
   {name:"Revenue",target:"2025-01-31"},
   {name:"Clients",target:"2025-02-28"},
   {name:"Costs",target:"2025-03-15"}
 ]},
 {name:"Health",target:"2025-06-30",subgoals:[
   {name:"Walking",target:"2025-04-30"},
   {name:"Diet",target:"2025-05-31"},
   {name:"Sleep",target:"2025-06-15"}
 ]}
];

const DEFAULT_LION="https://upload.wikimedia.org/wikipedia/commons/7/73/Lion_waiting_in_Namibia.jpg";
const DEFAULT_CROWN="https://upload.wikimedia.org/wikipedia/commons/3/3e/Golden_crown.svg";

let completedGoals=new Set();
let completedSubs=new Set();

const path=document.getElementById("path");
const lionWrap=document.getElementById("lionWrap");
const lion=document.getElementById("lion");
const crown=document.getElementById("crown");
const progress=document.getElementById("progress");
const goalsDiv=document.getElementById("goals");

function pct(i){return 4+(92*(i/GOALS.length));}

function rebuildPath(){
 path.innerHTML="";
 GOALS.forEach((_,i)=>{
  let seg=document.createElement("div");
  seg.className="segment";
  seg.id="seg"+i;
  seg.style.left=pct(i)+"%";
  seg.style.width=(92/GOALS.length)+"%";
  path.appendChild(seg);

  let paw=document.createElement("div");
  paw.className="paw";
  paw.id="paw"+i;
  paw.textContent="ðŸ¾";
  paw.style.left=(pct(i)+(92/GOALS.length)/2)+"%";
  path.appendChild(paw);
 });
}

function render(){
 goalsDiv.innerHTML="";
 GOALS.forEach((g,gi)=>{
  let div=document.createElement("div");
  div.className="goal";
  div.innerHTML=`
   <label>
    <input type="checkbox" onchange="toggleGoal(${gi})">
    <input type="text" value="${g.name}" onchange="renameGoal(${gi},this.value)">
   </label><br>
   Target: <input type="date" value="${g.target}" onchange="setGoalDate(${gi},this.value)">
   <button onclick="addSub(${gi})">âž• Sub</button>
  `;
  g.subgoals.forEach((s,si)=>{
   div.innerHTML+=`
    <div class="sub">
     <label>
      <input type="checkbox" onchange="toggleSub(${gi},${si})">
      <input type="text" value="${s.name}" onchange="renameSub(${gi},${si},this.value)">
     </label>
     Target: <input type="date" value="${s.target}" onchange="setSubDate(${gi},${si},this.value)">
    </div>`;
  });
  goalsDiv.appendChild(div);
 });
 update();
}

function isGoalDone(i){
 return GOALS[i].subgoals.length===0 ||
  GOALS[i].subgoals.every((_,si)=>completedSubs.has(i+"-"+si));
}

function update(){
 const done=[...completedGoals].length;
 lionWrap.style.left=pct(done)+"%";

 GOALS.forEach((_,i)=>{
  document.getElementById("seg"+i).classList.toggle("complete",completedGoals.has(i));
  const paw=document.getElementById("paw"+i);
  paw.classList.toggle("show",completedGoals.has(i));
  paw.classList.toggle("walk",completedGoals.has(i));
 });

 progress.textContent=Math.round((done/GOALS.length)*100)+"%";

 if(done===GOALS.length && GOALS.length>0){
  lion.style.display="none";
  crown.classList.add("show");
 }else{
  lion.style.display="block";
  crown.classList.remove("show");
 }
}

function toggleGoal(i){
 completedGoals.has(i)?completedGoals.delete(i):completedGoals.add(i);
 update();
}

function toggleSub(g,s){
 let k=g+"-"+s;
 completedSubs.has(k)?completedSubs.delete(k):completedSubs.add(k);
 isGoalDone(g)?completedGoals.add(g):completedGoals.delete(g);
 update();
}

function addGoal(){
 GOALS.push({name:"New Goal",target:"",subgoals:[]});
 rebuildPath();render();
}
function addSub(g){GOALS[g].subgoals.push({name:"New Sub-goal",target:""});render();}
function renameGoal(i,v){GOALS[i].name=v}
function renameSub(g,s,v){GOALS[g].subgoals[s].name=v}
function setGoalDate(i,d){GOALS[i].target=d}
function setSubDate(g,s,d){GOALS[g].subgoals[s].target=d}
function resetProgress(){completedGoals.clear();completedSubs.clear();update();}

document.getElementById("lionUpload").addEventListener("change",e=>{
 const f=e.target.files[0]; if(!f)return;
 const r=new FileReader(); r.onload=()=>{lion.src=r.result; saveState();};
 r.readAsDataURL(f);
});
document.getElementById("crownUpload").addEventListener("change",e=>{
 const f=e.target.files[0]; if(!f)return;
 const r=new FileReader(); r.onload=()=>{crown.src=r.result; saveState();};
 r.readAsDataURL(f);
});
function restoreLion(){lion.src=DEFAULT_LION; saveState();}
function restoreCrown(){crown.src=DEFAULT_CROWN; saveState();}

function saveState(){
 localStorage.setItem("lionProPlusPWA",JSON.stringify({
  goals:GOALS,
  cg:[...completedGoals],
  cs:[...completedSubs],
  lion:lion.src,
  crown:crown.src
 }));
}
function clearState(){
 localStorage.removeItem("lionProPlusPWA");
 location.reload();
}
(function load(){
 const d=JSON.parse(localStorage.getItem("lionProPlusPWA")||"null");
 if(!d)return;
 GOALS=d.goals||GOALS;
 completedGoals=new Set(d.cg||[]);
 completedSubs=new Set(d.cs||[]);
 if(d.lion) lion.src=d.lion;
 if(d.crown) crown.src=d.crown;
})();

rebuildPath();
render();

if ("serviceWorker" in navigator) {
 navigator.serviceWorker.register("service-worker.js");
}
</script>
</body>
</html>
